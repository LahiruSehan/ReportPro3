<!DOCTYPE html>
<html lang="en" data-app-theme="bizsense">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>BIZSENSE STATEMENT PRO</title>
  
  <link rel="icon" type="image/png" href="https://i.ibb.co/7mmBhMJ/LOGO.png">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');
    
    :root {
      --theme-primary: #6366f1;
      --app-bg: #0f172a;
      --app-card: #1e293b;
      --app-text: #f8fafc;
      --app-border: #334155;
    }

    body { background-color: var(--app-bg); color: var(--app-text); font-family: 'Inter', sans-serif; margin: 0; min-height: 100vh; overflow-x: hidden; }
    
    .view-hidden { display: none !important; }
    .glass-card { background: var(--app-card); border: 1px solid var(--app-border); border-radius: 0.75rem; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); }
    
    select, input[type="text"] { background: #0f172a !important; color: white !important; border: 1px solid var(--app-border) !important; padding: 0.6rem; border-radius: 0.5rem; outline: none; font-size: 0.85rem; }
    
    #select-organization {
      background: #312e81 !important;
      color: #ffffff !important;
      border: 1px solid #4f46e5 !important;
      padding: 6px 12px !important;
      cursor: pointer;
      font-weight: 700;
      border-radius: 6px;
      font-size: 0.75rem;
    }

    /* --- THE DOCUMENT (A4) STYLING --- */
    .a4-page {
      background: white; 
      color: #334155; 
      padding: 40px 50px; 
      min-height: 29.7cm; 
      width: 21cm; 
      margin: 20px auto; 
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5); 
      position: relative; 
      transform-origin: top center;
      transition: transform 0.2s ease;
      font-family: 'Inter', sans-serif;
    }

    .doc-header { display: flex; justify-content: space-between; margin-bottom: 40px; }
    .doc-brand { display: flex; flex-direction: column; gap: 5px; max-width: 50%; }
    .doc-title-block { text-align: right; }
    .doc-title { font-size: 24px; font-weight: 700; color: #1e293b; text-transform: uppercase; letter-spacing: -0.5px; margin: 0; }
    .doc-subtitle { font-size: 11px; color: #64748b; margin-top: 4px; }
    
    /* The "Blue Box" Summary - Classic Professional Look */
    .summary-section { 
        display: flex; 
        justify-content: space-between; 
        margin-bottom: 30px; 
        align-items: flex-end;
    }
    .customer-addr { font-size: 12px; color: #334155; line-height: 1.5; }
    .customer-addr strong { color: #0f172a; font-size: 14px; display: block; margin-bottom: 4px; }
    
    .account-summary-box {
        background: #f8fafc;
        border: 1px solid #e2e8f0;
        border-radius: 4px;
        width: 280px;
        padding: 15px;
    }
    .as-row { display: flex; justify-content: space-between; font-size: 11px; color: #475569; margin-bottom: 6px; }
    .as-row.total { 
        border-top: 2px solid #cbd5e1; 
        margin-top: 8px; 
        padding-top: 8px; 
        font-weight: 800; 
        font-size: 13px; 
        color: #0f172a; 
    }

    /* High Fidelity Table */
    .soa-table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 11px; }
    .soa-table th { 
      background-color: #334155; 
      color: #ffffff; 
      font-weight: 600; 
      text-transform: uppercase; 
      font-size: 10px; 
      padding: 8px 10px;
      letter-spacing: 0.5px;
    }
    .soa-table td { 
      padding: 12px 10px; 
      border-bottom: 1px solid #e2e8f0; 
      color: #334155;
      vertical-align: top;
    }
    .soa-table tr:last-child td { border-bottom: 2px solid #334155; }
    
    .item-details { margin-top: 4px; padding-left: 8px; border-left: 2px solid #e2e8f0; }
    .item-row { display: flex; justify-content: space-between; font-size: 10px; color: #64748b; margin-top: 2px; }

    /* App UI */
    .view-dashboard { display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
    .sidebar { width: 320px; flex-shrink: 0; display: flex; flex-direction: column; gap: 10px; }
    .main-area { flex-grow: 1; display: flex; flex-direction: column; overflow: hidden; position: relative; }
    .paper-scroller { flex-grow: 1; overflow-y: auto; background: #334155; padding: 20px; display: flex; justify-content: center; }

    /* Loading Bar */
    #loading-bar-container { position: fixed; top: 0; left: 0; width: 100%; height: 4px; z-index: 1000; background: rgba(255,255,255,0.1); }
    #loading-bar { height: 100%; width: 0%; background: #6366f1; transition: width 0.2s; box-shadow: 0 0 10px #6366f1; }
    
    /* Helper for PDF Export */
    #pdf-export-temp { position: absolute; left: -9999px; top: 0; }

    @media print {
      body { background: white !important; }
      .no-print, .sidebar, header { display: none !important; }
      .a4-page { margin: 0 !important; box-shadow: none !important; transform: none !important; width: 100% !important; height: auto !important; }
      .paper-scroller { background: white !important; padding: 0 !important; display: block !important; }
    }
  </style>
</head>
<body class="flex flex-col min-h-screen">

  <div id="loading-bar-container" class="view-hidden"><div id="loading-bar"></div></div>
  <div id="pdf-export-temp"></div>

  <!-- Landing/Login -->
  <div id="view-landing" class="fixed inset-0 bg-[#0f172a] flex items-center justify-center p-6 text-center z-[500] view-hidden">
    <div class="glass-card p-12 max-w-md w-full flex flex-col items-center">
      <h1 class="text-4xl font-black mb-2 tracking-tighter text-white">BIZSENSE<span class="text-indigo-500">.AI</span></h1>
      <p class="text-slate-400 text-sm mb-8">Advanced Statement Engine</p>
      <button id="btn-connect" class="w-full py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-bold text-xs uppercase tracking-widest transition-colors">Connect Zoho Books</button>
      <div id="landing-error" class="view-hidden mt-4 text-red-400 text-xs"></div>
    </div>
  </div>

  <!-- Config Modal -->
  <div id="modal-config" class="fixed inset-0 bg-black/80 flex items-center justify-center p-4 z-[600] view-hidden">
    <div class="glass-card p-8 w-full max-w-lg space-y-4">
      <h3 class="text-lg font-bold text-white uppercase tracking-wide">API Configuration</h3>
      <div class="space-y-2">
        <label class="text-xs text-slate-400 font-bold uppercase">Client ID</label>
        <input id="cfg-client-id" type="text" class="w-full" placeholder="Enter Zoho Client ID">
      </div>
      <div class="space-y-2">
         <label class="text-xs text-slate-400 font-bold uppercase">Region</label>
        <select id="cfg-region" class="w-full font-bold">
          <option value="com">zoho.com (US/Global)</option>
          <option value="in">zoho.in (India)</option>
          <option value="eu">zoho.eu (Europe)</option>
          <option value="com.au">zoho.com.au (Australia)</option>
        </select>
      </div>
      <button id="btn-save-config" class="w-full py-3 mt-4 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-bold text-xs uppercase">Save & Initialize</button>
    </div>
  </div>

  <!-- Main Dashboard -->
  <div id="view-dashboard" class="view-dashboard view-hidden">
    
    <!-- Top Header -->
    <header class="h-16 border-b border-slate-700/50 bg-[#0f172a] flex items-center justify-between px-6 flex-shrink-0 z-20">
      <div class="flex items-center gap-6">
        <div class="flex items-center gap-2">
          <div class="w-8 h-8 bg-indigo-600 rounded-lg flex items-center justify-center font-black text-white text-lg">B</div>
          <span class="font-bold text-lg tracking-tight text-white">BIZSENSE</span>
        </div>
        <div class="h-6 w-px bg-slate-700"></div>
        <div class="flex flex-col">
            <span class="text-[9px] text-slate-400 font-bold uppercase">Active Organization</span>
            <select id="select-organization" class="mt-0.5 bg-transparent border-none p-0 text-sm font-bold text-white focus:ring-0"></select>
        </div>
      </div>
      <div class="flex items-center gap-4">
        <button id="btn-logout" class="text-slate-400 hover:text-white text-xs font-bold uppercase">Logout</button>
      </div>
    </header>

    <div class="flex flex-grow overflow-hidden">
        
      <!-- Sidebar -->
      <aside class="sidebar bg-[#1e293b] border-r border-slate-700/50 p-4 hidden md:flex">
        <div class="relative mb-4">
            <input type="text" id="customer-search" placeholder="Search Customers..." class="w-full pl-9 bg-slate-800 border-slate-700 focus:border-indigo-500 transition-colors">
            <svg class="w-4 h-4 text-slate-500 absolute left-3 top-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
        </div>
        
        <div class="flex justify-between items-center mb-2 px-1">
            <span class="text-[10px] font-bold text-slate-500 uppercase tracking-wider">Customer List</span>
            <button id="btn-clear-all" class="text-[9px] text-indigo-400 hover:text-indigo-300 font-bold uppercase">Reset</button>
        </div>

        <div id="customer-list" class="flex-grow overflow-y-auto space-y-1 pr-1 scrollbar-thin scrollbar-thumb-slate-700">
            <!-- Customer items injected here -->
        </div>
      </aside>

      <!-- Main Content Area -->
      <main class="main-area">
        <!-- Toolbar -->
        <div class="h-14 bg-[#1e293b]/50 border-b border-slate-700/50 flex items-center justify-between px-6 backdrop-blur-md z-10">
            <div class="flex items-center gap-3">
                <button id="btn-download-pdf" disabled class="flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-500 disabled:bg-slate-700 disabled:text-slate-500 text-white rounded-md text-xs font-bold uppercase transition-all shadow-lg shadow-indigo-900/20">
                    <span>Export PDF</span>
                </button>
                <button id="btn-download-excel" disabled class="flex items-center gap-2 px-4 py-2 bg-emerald-600 hover:bg-emerald-500 disabled:bg-slate-700 disabled:text-slate-500 text-white rounded-md text-xs font-bold uppercase transition-all shadow-lg shadow-emerald-900/20">
                    <span>Export Excel</span>
                </button>
            </div>
            
            <div class="flex items-center gap-4">
                <div class="flex items-center gap-2">
                    <label class="text-[10px] font-bold text-slate-400 uppercase">Logo:</label>
                    <label class="cursor-pointer px-3 py-1.5 bg-slate-700 hover:bg-slate-600 text-white text-[10px] font-bold uppercase rounded transition-colors">
                        Upload
                        <input type="file" id="logo-upload" accept="image/*" class="hidden">
                    </label>
                </div>
                <div class="flex bg-slate-800 rounded-lg p-1">
                    <button id="btn-zoom-out" class="w-7 h-7 flex items-center justify-center text-slate-400 hover:text-white font-bold">-</button>
                    <span class="w-8 flex items-center justify-center text-xs font-mono text-slate-300">A4</span>
                    <button id="btn-zoom-in" class="w-7 h-7 flex items-center justify-center text-slate-400 hover:text-white font-bold">+</button>
                </div>
            </div>
        </div>

        <!-- Paper Canvas -->
        <div id="area-ledger" class="paper-scroller">
            <div id="statement-render-target"></div>
            
            <div id="empty-state" class="flex flex-col items-center justify-center mt-32 opacity-20 select-none">
                <svg class="w-32 h-32 text-slate-400 mb-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                <p class="text-xl font-black text-slate-400 uppercase tracking-widest">Select a Customer</p>
                <p class="text-sm text-slate-500 mt-2">Generate Statement of Accounts</p>
            </div>
        </div>

      </main>
    </div>
  </div>

  <script type="module" src="index.js"></script>
</body>
</html>